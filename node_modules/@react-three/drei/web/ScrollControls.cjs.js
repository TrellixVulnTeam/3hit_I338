"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("three"),r=require("react"),s=require("react-dom"),o=require("@react-three/fiber"),n=require("react-merge-refs");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var i=l(e),u=a(t),f=a(r),c=a(s),d=l(n);const p=f.createContext(null);function h(){return f.useContext(p)}const m=f.forwardRef((({html:e,...t},r)=>{const s=e?v:g;return f.createElement(s,i.default({ref:r},t))})),g=f.forwardRef((({children:e},t)=>{const r=f.useRef(null),s=h(),{width:n,height:l}=o.useThree((e=>e.viewport));return o.useFrame((()=>{r.current.position.x=s.horizontal?-n*(s.pages-1)*s.offset:0,r.current.position.y=s.horizontal?0:l*(s.pages-1)*s.offset})),f.createElement("group",{ref:d.default([t,r])},e)})),v=f.forwardRef((({children:e,style:t,...r},s)=>{const n=h(),l=f.useRef(null),{width:a,height:u}=o.useThree((e=>e.size)),m=f.useContext(o.context);return o.useFrame((()=>{n.delta>n.eps&&(l.current.style.transform=`translate3d(${n.horizontal?-a*(n.pages-1)*n.offset:0}px,${n.horizontal?0:u*(n.pages-1)*-n.offset}px,0)`)})),c.render(f.createElement("div",i.default({ref:d.default([s,l]),style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},r),f.createElement(p.Provider,{value:n},f.createElement(o.context.Provider,{value:m},e))),n.fixed),null}));exports.Scroll=m,exports.ScrollControls=function({eps:e=1e-5,horizontal:t,pages:r=1,distance:s=1,damping:n=4,children:l}){const a=o.useThree((e=>e.gl)),i=o.useThree((e=>e.invalidate)),c=o.useThree((e=>e.events)),d=o.useThree((e=>e.raycaster)),[h]=f.useState((()=>document.createElement("div"))),[m]=f.useState((()=>document.createElement("div"))),[g]=f.useState((()=>document.createElement("div"))),v=a.domElement.parentNode,y=f.useRef(0),x=f.useMemo((()=>({el:h,eps:e,fill:m,fixed:g,horizontal:t,damping:n,offset:0,delta:0,pages:r,range(e,t){const r=e+t;return this.offset<e?0:this.offset>r?1:(this.offset-e)/(r-e)},visible(e,t){const r=e+t;return this.offset>=e&&this.offset<=r}})),[e,n,t,r]);f.useEffect((()=>{h.style.position="absolute",h.style.width="100%",h.style.height="100%",h.style[t?"overflowX":"overflowY"]="auto",h.style.top="0px",h.style.left="0px",g.style.position="sticky",g.style.top="0px",g.style.left="0px",h.appendChild(g),m.style.height=t?"100%":r*s*100+"%",m.style.width=t?r*s*100+"%":"100%",m.style.pointerEvents="none",h.appendChild(m);const e=e=>{i(),y.current=t?e.target.scrollLeft/(e.target.scrollWidth-e.target.clientWidth):e.target.scrollTop/(e.target.scrollHeight-e.target.clientHeight)};return h.addEventListener("scroll",e,{passive:!0}),v.appendChild(h),requestAnimationFrame((()=>null==c.connect?void 0:c.connect(h))),d.computeOffsets=({clientX:e,clientY:t})=>({offsetX:e,offsetY:t}),()=>{v.removeChild(h),h.removeEventListener("scroll",e)}}),[i,s,n,r,t]);let b=0;return o.useFrame(((t,r)=>{x.offset=u.MathUtils.damp(b=x.offset,y.current,n,r),x.delta=u.MathUtils.damp(x.delta,Math.abs(b-x.offset),n,r),x.delta>e&&i()})),f.createElement(p.Provider,{value:x},l)},exports.useScroll=h;
